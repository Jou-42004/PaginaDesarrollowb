<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Iniciar Sesión - Fit Express</title>
  <meta name="description" content="Inicia sesión en Fit Express para disfrutar de bowls proteicos y snacks saludables">
  <style>
    :root{
      --text:#ecfdf5; --muted:#b7e4cf; --panel:#0e2a1a; --ring:rgba(34,197,94,.35);
      --accent:#22c55e; --cta:#6d28d9; --cta-text:#f9f5ff;
      --error:#ef4444; --success:#10b981; --warning:#f59e0b;
      --hero-overlay: radial-gradient(900px 700px at 110% -10%, rgba(34,197,94,.30) 0%, rgba(34,197,94,0) 60%);
    }
    *{box-sizing:border-box} html,body{margin:0;height:100%}
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;background:#0b1f14;color:var(--text)}
    
    /* Header */
    header{
      position:sticky;
      top:0;
      z-index:10;
      backdrop-filter:blur(8px);
      background:linear-gradient(180deg, rgba(11,42,24,.9), rgba(11,42,24,.65));
      border-bottom:1px solid rgba(183,210,192,.18);
      padding: 8px 0;
    }
    .container{max-width:1200px;margin:0 auto;padding:0 16px}
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      height: 60px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      font-weight:900;
      flex-shrink: 0;
    }
    .logo{
      width:32px;
      height:32px;
      border-radius:8px;
      background:#19c268;
      box-shadow:0 0 18px #19c268 inset,0 0 18px #19c268;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
    }
    .brand span{font-size:20px; color: var(--text);}
    
    /* Acciones */
    .actions{
      display:flex;
      align-items:center;
      gap:16px;
      margin-left: auto;
    }
    .icon-btn{
      display:inline-grid;
      place-items:center;
      width:40px;
      height:40px;
      border-radius:12px;
      border:1px solid rgba(183,210,192,.25);
      background:rgba(17, 57, 35, 0.6);
      text-decoration:none;
      transition: all 0.2s ease;
      position: relative;
    }
    .icon-btn:hover{
      border-color:var(--accent);
      background:rgba(34,197,94,.15);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(34,197,94,.2);
    }
    .icon{
      width:20px;
      height:20px;
      stroke:#e2e8f0;
      stroke-width:2;
    }
    
    /* Main Content */
    .main-content {
      min-height: calc(100vh - 160px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 0;
    }
    
    .login-card {
      background: linear-gradient(180deg, rgba(18,56,35,.85), rgba(10,38,23,.85));
      border: 1px solid rgba(183,210,192,.18);
      border-radius: 20px;
      padding: 40px 30px;
      width: 100%;
      max-width: 450px;
      box-shadow: 0 20px 40px rgba(0,0,0,.3);
    }
    
    .login-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .login-header h1 {
      font-size: 28px;
      margin: 0 0 10px;
      color: var(--text);
    }
    
    .login-header p {
      color: var(--muted);
      margin: 0;
      font-size: 16px;
    }
    
    /* Alert Styles */
    .alert {
      padding: 12px 16px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: none;
    }
    
    .alert-success {
      background: rgba(16, 185, 129, 0.2);
      border: 1px solid var(--success);
      color: var(--success);
    }
    
    .alert-error {
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid var(--error);
      color: var(--error);
    }
    
    .alert-warning {
      background: rgba(245, 158, 11, 0.2);
      border: 1px solid var(--warning);
      color: var(--warning);
    }
    
    /* Form Styles */
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text);
    }
    
    .form-control {
      width: 100%;
      padding: 12px 16px;
      background: rgba(11, 42, 24, 0.7);
      border: 1px solid rgba(183,210,192,.25);
      border-radius: 10px;
      color: var(--text);
      font-size: 16px;
      transition: all 0.2s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--ring);
    }
    
    .form-control.error {
      border-color: var(--error);
    }
    
    .error-message {
      color: var(--error);
      font-size: 14px;
      margin-top: 5px;
      display: none;
    }
    
    .form-control.error + .error-message {
      display: block;
    }
    
    /* Button Styles */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 14px 24px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 16px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
    }
    
    .btn-primary {
      background: var(--cta);
      color: var(--cta-text);
    }
    
    .btn-primary:hover {
      filter: brightness(.9);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(109, 40, 217, 0.3);
    }
    
    .btn-secondary {
      background: rgba(183,210,192,.1);
      color: var(--text);
      border: 1px solid rgba(183,210,192,.25);
    }
    
    .btn-secondary:hover {
      background: rgba(183,210,192,.2);
      transform: translateY(-1px);
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }
    
    /* Checkbox Styles */
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .checkbox-group input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--accent);
    }
    
    .checkbox-group label {
      margin: 0;
      font-weight: normal;
    }
    
    /* Login Options */
    .login-options {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .forgot-password {
      color: var(--accent);
      text-decoration: none;
      font-size: 14px;
    }
    
    .forgot-password:hover {
      text-decoration: underline;
    }
    
    /* Session Info */
    .session-info {
      text-align: center;
      color: var(--muted);
      font-size: 14px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(183,210,192,.1);
    }
    
    footer{
      padding:30px 16px 50px;
      color:var(--muted);
      text-align:center;
      border-top:1px solid rgba(183,210,192,.18);
      background:var(--panel);
    }
    
    /* Responsive */
    @media (max-width: 576px) {
      .login-card {
        padding: 30px 20px;
      }
      
      .login-options {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container topbar">
      <div class="brand">
        <a href="index.html" style="text-decoration: none; display: flex; align-items: center; gap: 12px;">
          <div class="logo">FE</div>
          <span>Fit Express</span>
        </a>
      </div>

      <nav class="actions" aria-label="Acciones">
        <a class="icon-btn" href="index.html" title="Inicio">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke-width="2" aria-hidden="true">
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
        </a>
        <a class="icon-btn" href="perfil.html" title="Mi perfil">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke-width="2" aria-hidden="true">
            <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Z"></path>
            <path d="M20 21a8 8 0 1 0-16 0"></path>
          </svg>
        </a>
        <a class="icon-btn" href="carrito.html" title="Carrito de compras">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke-width="2" aria-hidden="true">
            <path d="M6 7h12l-1 12H7L6 7Z"></path>
            <path d="M9 7V6a3 3 0 0 1 6 0v1"></path>
          </svg>
        </a>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <div class="main-content">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-md-8 col-lg-6">
          <div class="login-card">
            <div class="login-header">
              <h1>Iniciar Sesión</h1>
              <p>Accede a tu cuenta para gestionar tus pedidos y favoritos</p>
            </div>
            
            <!-- Alert Messages -->
            <div id="successAlert" class="alert alert-success">
              Acceso concedido. Redirigiendo...
            </div>
            
            <div id="errorAlert" class="alert alert-error">
              Credenciales inválidas
            </div>
            
            <div id="blockedAlert" class="alert alert-warning">
              Cuenta temporalmente bloqueada (5 intentos / 15 min)
            </div>
            
            <form id="loginForm">
              <div class="row justify-content-start">
                <div class="col-12">
                  <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" class="form-control" placeholder="ana@example.com" required>
                    <div class="error-message">Por favor ingresa un correo válido</div>
                  </div>
                </div>
              </div>
              
              <div class="row justify-content-start">
                <div class="col-12">
                  <div class="form-group">
                    <label for="password">Contraseña</label>
                    <input type="password" id="password" class="form-control" placeholder="**********" required>
                    <div class="error-message">Por favor ingresa tu contraseña</div>
                  </div>
                </div>
              </div>
              
              <div class="row justify-content-between">
                <div class="col-6">
                  <div class="checkbox-group">
                    <input type="checkbox" id="remember">
                    <label for="remember">Recordarme</label>
                  </div>
                </div>
                <div class="col-6 text-end">
                  <a href="B03-CambioContraseña.html"lass="forgot-password">¿Olvidaste tu contraseña?</a>
                </div>
              </div>
              
              <div class="row justify-content-start">
                <div class="col-12">
                  <div class="form-group">
                    <button type="submit" class="btn btn-primary">Iniciar sesión</button>
                  </div>
                </div>
              </div>
            </form>
            
            <div class="row justify-content-start">
              <div class="col-12">
                <div class="session-info">
                  Sesión expira a los 30 min de inactividad — Logout manual disponible
                </div>
              </div>
            </div>
            
            <div class="row justify-content-start">
              <div class="col-12">
                <div style="text-align: center; margin-top: 20px;">
                  <a href="B01-RegistroUsuario.html" class="btn btn-secondary">¿No tienes cuenta? Regístrate</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>© <span id="y"></span> Fit Express — Bowls proteicos y snacks saludables</footer>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
    
    // Login functionality
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('loginForm');
      const successAlert = document.getElementById('successAlert');
      const errorAlert = document.getElementById('errorAlert');
      const blockedAlert = document.getElementById('blockedAlert');
      
      // Track login attempts
      let loginAttempts = parseInt(localStorage.getItem('loginAttempts') || '0');
      let lastAttemptTime = parseInt(localStorage.getItem('lastAttemptTime') || '0');
      let isBlocked = localStorage.getItem('isBlocked') === 'true';
      
      // Check if user is still blocked
      if (isBlocked) {
        const currentTime = Date.now();
        const blockTime = parseInt(localStorage.getItem('blockTime') || '0');
        const blockDuration = 15 * 60 * 1000; // 15 minutes in milliseconds
        
        if (currentTime - blockTime < blockDuration) {
          showBlockedAlert();
        } else {
          // Block expired
          resetLoginAttempts();
        }
      }
      
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Hide all alerts
        hideAllAlerts();
        
        // Check if account is blocked
        if (isBlocked) {
          showBlockedAlert();
          return;
        }
        
        // Basic validation
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        let isValid = true;
        
        // Email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          document.getElementById('email').classList.add('error');
          isValid = false;
        } else {
          document.getElementById('email').classList.remove('error');
        }
        
        // Password validation
        if (password.length < 1) {
          document.getElementById('password').classList.add('error');
          isValid = false;
        } else {
          document.getElementById('password').classList.remove('error');
        }
        
        if (isValid) {
          // Simulate login process
          const submitBtn = form.querySelector('button[type="submit"]');
          const originalText = submitBtn.textContent;
          submitBtn.textContent = 'Iniciando sesión...';
          submitBtn.disabled = true;
          
          // Simulate API call delay
          setTimeout(function() {
            // Demo scenarios - in real app this would be server response
            const scenarios = ['success', 'error', 'blocked'];
            const randomScenario = scenarios[Math.floor(Math.random() * scenarios.length)];
            
            switch(randomScenario) {
              case 'success':
                handleSuccessfulLogin();
                break;
              case 'error':
                handleFailedLogin();
                break;
              case 'blocked':
                handleBlockedAccount();
                break;
            }
            
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
          }, 1500);
        }
      });
      
      function handleSuccessfulLogin() {
        // Reset login attempts on successful login
        resetLoginAttempts();
        
        // Show success message
        successAlert.style.display = 'block';
        
        // Store remember me preference
        const rememberMe = document.getElementById('remember').checked;
        if (rememberMe) {
          localStorage.setItem('rememberMe', 'true');
          localStorage.setItem('userEmail', document.getElementById('email').value);
        } else {
          localStorage.removeItem('rememberMe');
          localStorage.removeItem('userEmail');
        }
        
        // Store session start time (30 minutes)
        const sessionStart = Date.now();
        localStorage.setItem('sessionStart', sessionStart.toString());
        
        // Redirect after delay
        setTimeout(function() {
          window.location.href = 'perfil.html';
        }, 2000);
      }
      
      function handleFailedLogin() {
        // Increment login attempts
        loginAttempts++;
        lastAttemptTime = Date.now();
        
        localStorage.setItem('loginAttempts', loginAttempts.toString());
        localStorage.setItem('lastAttemptTime', lastAttemptTime.toString());
        
        // Check if should block account
        if (loginAttempts >= 5) {
          handleBlockedAccount();
          return;
        }
        
        // Show error message (neutral message as per requirements)
        errorAlert.style.display = 'block';
      }
      
      function handleBlockedAccount() {
        // Block the account
        isBlocked = true;
        const blockTime = Date.now();
        
        localStorage.setItem('isBlocked', 'true');
        localStorage.setItem('blockTime', blockTime.toString());
        localStorage.setItem('loginAttempts', '5');
        
        showBlockedAlert();
      }
      
      function showBlockedAlert() {
        blockedAlert.style.display = 'block';
        isBlocked = true;
      }
      
      function resetLoginAttempts() {
        loginAttempts = 0;
        isBlocked = false;
        localStorage.setItem('loginAttempts', '0');
        localStorage.setItem('isBlocked', 'false');
        localStorage.removeItem('blockTime');
      }
      
      function hideAllAlerts() {
        successAlert.style.display = 'none';
        errorAlert.style.display = 'none';
        blockedAlert.style.display = 'none';
      }
      
      // Pre-fill email if remember me was checked
      if (localStorage.getItem('rememberMe') === 'true') {
        const savedEmail = localStorage.getItem('userEmail');
        if (savedEmail) {
          document.getElementById('email').value = savedEmail;
          document.getElementById('remember').checked = true;
        }
      }
    });
  </script>
</body>
</html>